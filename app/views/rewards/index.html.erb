<h1>Rewards (admin view) </h1>
<p>All of the rewards that can be purchased with points are shown below.</p>
<%= link_to("Add New Reward", new_reward_path, class: 'primary_link') %>
<br> <br>

<!-- search bar & buttons -->
<div>
  <%= label_tag "search", "Search:" %>
  <%= text_field_tag "search", nil, id: "search_bar" %>
</div>

<table id="rewards_table" class="listing" summary="Reward list" style="width: 100%;>
  <tr class="header">
    <th>Name</th>
    <th>Point price</th>
    <th>Dollar price</th>
    <th>Current inventory</th>
    <th>Actions</th>
  </tr>
  <% @rewards.each do |reward| %>
    <tr>
      <td><%= reward.name %></td>
      <td><%= reward.point_value %></td>
      <td><%= reward.dollar_price  %></td>
      <td><%= reward.inventory %></td>
      <td class="actions">
        <%= link_to("See details", reward_path(reward), class: "primary_link") %>
        <%= link_to("Edit", edit_reward_path(reward), class: "primary_link") %>
        <%= link_to("Delete", delete_reward_path(reward), class: "primary_link") %>
      </td>
    </tr>
  <% end %>
</table>
<br />
<% flash.each do |type, message| %>
  <div class="flash flash-<%= type %>">
    <%= message %>
  </div>
<% end %>

<script>

// JavaScript for filtering members based on the search bar
const searchInput = document.getElementById("search_bar");
const rewardTable = document.getElementById("rewards_table");

searchInput.addEventListener("input", () => {
  const searchQuery = searchInput.value.trim().toLowerCase();
  const rows = rewardTable.querySelectorAll("tr");

  // Start from the second row (index 1) to skip the header row
  for (let i = 1; i < rows.length; i++) {
    const row = rows[i];
    const rewardName = row.querySelector("td:first-child").textContent.trim().toLowerCase();
    const isVisible = rewardName.includes(searchQuery);
    row.style.display = isVisible ? "table-row" : "none";
  }
});

</script>
